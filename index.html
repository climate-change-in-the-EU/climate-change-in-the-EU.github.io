<!DOCTYPE html>
<html lang="en">

<head>

  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">

  <title>Europinion on Climate Change</title>

  <!-- Bootstrap core CSS -->
  <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

  <!-- Custom styles for this template -->
  <link href="css/scrolling-nav.css" rel="stylesheet">

  <!-- necessary scripts for data processing and visualization -->
  <script src="js/plotly-latest.min.js"></script>
  <script src="js/d3.v5.js"></script>
  <script src="js/xmlToJson.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
        integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
        crossorigin=""/>
  <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"
          integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="
          crossorigin=""></script>
  <script src="js/leaflet.ajax.min.js"></script>

</head>

<body id="page-top">

  <!-- Navigation -->
  <nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top" id="mainNav">
    <div class="container">
      <a class="navbar-brand js-scroll-trigger" href="#page-top">Europinion on Climate Change</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarResponsive">
        <ul class="navbar-nav ml-auto">
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="#introduction">Introduction</a>
          </li>
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="#visualization">Visualization</a>
          </li>
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="#original-datasets">Original datasets</a>
          </li>
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="#output-datasets">Output datasets</a>
          </li>
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="#documentation">Documentation</a>
          </li>
          <li class="nav-item">
            <a class="nav-link js-scroll-trigger" href="#license">License</a>
          </li>
        </ul>
      </div>
    </div>
  </nav>

  <header class="bg-primary text-white">
    <div class="container text-center">
      <h1>Europinion on Climate Change</h1>
      <p class="lead">An overview of the European peoples' judgments and actions concerning climate change</p>
    </div>
  </header>

  <section id="introduction">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 mx-auto">
          <h2>Introduction</h2>
          <p class="lead">This project investigates the European public's opinion on the problem of climate change and attempts to correlate it with various data on actual national greenhouse gas emissions and energy usage from renewable sources.
            It uses openly accessible datasets which have been processed for comparability and visualized in the form of graphs.
            The leading questions these reports address are as follows:</p>
          <ul>
            <li>Do Europeans have comparable views on the problem of climate change across countries? If so, has this been always been the case in past years?</li>
            <li>Generally, how serious do Europeans deem the problem of climate change to be?</li>
            <li>Does the concern for climate change reflect in national consumption statistics, e.g. greenhouse gas emissions or the share of energy generated from renewable sources?</li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <section id="visualization" class="bg-light">
    <div class="container">
      <div class="row">
        <div class="col-xl-8 mx-auto">
          <h2>Visualization</h2>
          <!--
          <div id="comparison_problem_renewables_eu"></div>
          <div id="most_serious_problem_plot"></div>
          <div id="avg_severity_plot"></div>
          <div id="map_severity"></div>
          <div id="ghg_emissions_plot"></div>
          <div id="share_renewable_plot"></div>
          <div id="map_renewables_2017"></div>
          <script>

            comparison_problem_renewables_eu = document.getElementById("comparison_problem_renewables_eu")
            most_serious_problem_plot = document.getElementById("most_serious_problem_plot");
            avg_severity_plot = document.getElementById("avg_severity_plot");
            map_severity = document.getElementById("map_severity");
            ghg_emissions_plot = document.getElementById("ghg_emissions_plot");
            share_renewable_plot = document.getElementById("share_renewable_plot");
            map_renewables_2017 = document.getElementById("map_renewables_2017");

            Promise.all([
                        d3.xml("processed_data/most_serious_problem/most_serious_problem.xml"),
                        d3.tsv("processed_data/share_renewable/share_renewable.tsv")
                      ]).then(function(data) {
                        plot_data = [];
                        var dataobj_problem = xmlToJson.parse(data[0]).root.survey;
                        var surveys = {};
                        for (i = 0; i < dataobj_problem.length; i++) {
                          var countries = {};
                          for (j = 0; j < dataobj_problem[i].country.length; j++) {
                            countries[dataobj_problem[i].country[j].id] = dataobj_problem[i].country[j].share;
                          }
                          surveys[dataobj_problem[i].date] = countries;
                        }

              var dataobj_renewable = data[1];
              var years = [2008,2009,2010,2011,2012,2013,2014,2015,2016,2017]
              var data_by_country = {};
              for (i = 4; i < dataobj_renewable.length; i++) {
                var country = dataobj_renewable[i]["geo\\time"];
                for (j = 0; j < years.length; j++) {
                  var values_by_year = Object.values(dataobj_renewable[i]).slice(1, );
                  data_by_country[country] = values_by_year;
                }
              }
              var trace1 = {
                x: years,
                y: data_by_country['EU2728']
              }
              plot_data.push(trace1);

              return surveys;
            }).then(function(surveys) {
              var data = Object.values(surveys);
              var surveys = Object.keys(surveys);
              var countries = Object.keys(data[0]);
              var data_by_country = {};
              for (i = 0; i < countries.length; i++) {
                data_by_country[countries[i]] = [];
                for (j = 0; j < surveys.length; j++) {
                  data_by_country[countries[i]].push(data[j][countries[i]]);
                }
              }

              var layout = {
                xaxis: {
                  type: 'date'
                },
                yaxis: {
                  ticksuffix: '%',
                  range: [5, 35],
                  title: 'consumption share of renewable energy'
                },
                yaxis2: {
                  tickformat: ',.0%',
                  range: [0.05, 0.35],
                  overlaying: 'y',
                  side: 'right',
                  title: '\"climate change is most significant problem\"'
                },
                showlegend: false,
                hoverinfo: 'text+y',
                hovermode: 'closest'
              };

                var country_id = Object.keys(data_by_country)[0];
                var trace2 = {
                  x: surveys,
                  y: data_by_country[country_id],
                  yaxis: 'y2'
                };
                plot_data.push(trace2)

              Plotly.plot( comparison_problem_renewables_eu, plot_data, layout, {scrollZoom: true})

            });

            d3.xml("processed_data/most_serious_problem/most_serious_problem.xml")
              .then(function(data) {
                var dataobj = xmlToJson.parse(data).root.survey;
                var surveys = {};
                for (i = 0; i < dataobj.length; i++) {
                  var countries = {};
                  for (j = 0; j < dataobj[i].country.length; j++) {
                    countries[dataobj[i].country[j].id] = dataobj[i].country[j].share;
                  }
                  surveys[dataobj[i].id] = countries;
                }
                return surveys;
              }).then(function(surveys) {
                var data = Object.values(surveys);
                var surveys = Object.keys(surveys);
                var countries = Object.keys(data[0]);
                var data_by_country = {};
                for (i = 0; i < countries.length; i++) {
                  data_by_country[countries[i]] = [];
                  for (j = 0; j < surveys.length; j++) {
                    data_by_country[countries[i]].push(data[j][countries[i]]);
                  }
                }

                var layout = {
                  xaxis: {
                    type: 'category',
                    title: 'Eurobarometer Survey'
                  },
                  yaxis: {
                    tickformat: ',.0%',
                    title: 'Share of Climate Change as most significan problem'
                  },
                  legend: {
                    itemclick: 'toggleothers',
                    itemdoubleclick: 'toggle'
                  },
                  hoverinfo: 'text+y',
                  hovermode: 'closest'
                };

                var plot_data = [];
                for (i = 0; i < countries.length; i++) {
                  var country_id = Object.keys(data_by_country)[i];
                  var trace = {
                    x: surveys,
                    y: data_by_country[country_id],
                    name: country_id
                  };
                  plot_data.push(trace);
                }

                Plotly.plot( most_serious_problem_plot, plot_data, layout, {scrollZoom: true})

            });

            d3.xml("processed_data/severity_of_problem/avg_severity.xml")
                    .then(function(data) {
                      var dataobj =  xmlToJson.parse(data).root.survey;
                      var surveys = {};
                      for (i = 0; i < dataobj.length; i++) {
                        var countries = {};
                        for (j = 0; j < dataobj[i].country.length; j++) {
                          countries[dataobj[i].country[j].id] = dataobj[i].country[j].avg;
                        }
                        surveys[dataobj[i].id] = countries;
                      }
                      return surveys;
                    }).then(function(surveys) {
              var data = Object.values(surveys);
              var surveys =  Object.keys(surveys);
              var countries = Object.keys(data[0]);
              var data_by_country = {};
              for (i = 0; i < countries.length; i++) {
                data_by_country[countries[i]] = [];
                for (j = 0; j < surveys.length; j++) {
                  data_by_country[countries[i]].push(data[j][countries[i]]);
                }
              }

              var layout = {
                xaxis: {
                  type: 'category',
                  title: 'Eurobarometer Survey'
                },
                yaxis: {
                  range: [5,10],
                  title: 'Judgment of climate change severity'
                },
                legend: {
                  itemclick: 'toggleothers',
                  itemdoubleclick: 'toggle'
                },
                hoverinfo: 'text+y',
                hovermode: 'closest'
              };

              var plot_data = [];
              for (i = 0; i < countries.length; i++) {
                var country_id = Object.keys(data_by_country)[i];
                var trace = {
                  x: surveys,
                  y: data_by_country[country_id],
                  name: country_id
                };
                plot_data.push(trace);
              }

              Plotly.plot( avg_severity_plot, plot_data, layout, {scrollZoom: true})

            });

            d3.xml("processed_data/severity_of_problem/avg_severity.xml")
                    .then(function(data) {
                      var dataobj =  xmlToJson.parse(data).root.survey;
                      var surveys = {};
                      for (i = 0; i < dataobj.length; i++) {
                        var countries = {};
                        for (j = 0; j < dataobj[i].country.length; j++) {
                          countries[dataobj[i].country[j].id] = dataobj[i].country[j].avg;
                        }
                        surveys[dataobj[i].id] = countries;
                      }
                      return surveys;
                    }).then(function(surveys) {
              var data = Object.values(surveys);
              var surveys =  Object.keys(surveys);
              var countries = Object.keys(data[0]);
              var data_by_country = {};
              for (i = 0; i < countries.length; i++) {
                data_by_country[countries[i]] = data[7][countries[i]];
              }

              var trace = {
                locations: Object.keys(data_by_country),
                z: Object.values(data_by_country),
                type: 'choropleth',
                geo: 'geo',
                colorscale: [
                  ['0', 'red'],
                  ['0.5', 'yellow'],
                  ['1', 'green']
                ],
                reversescale: false
              }

              var layout = {
                title: 'How serious do you consider the problem of climate change to be on a scale from 1 to 10?',
                geo: {
                  projection: 'mercator',
                  domain: {
                    x: [0, 1],
                    y: [0, 1]
                  },
                  lonaxis: { range: [-25, 45] },
                  lataxis: { range: [30, 80] }
                },
                hoverinfo: 'text+y',
                hovermode: 'closest'
              };

              data = [trace]
              Plotly.plot( map_severity, data, layout, {scrollZoom: true})

            });

            d3.tsv("processed_data/ghg_emissions/ghg_emissions.tsv")
                    .then(function(data) {

                      var data_by_country = {};

                      var years = [2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017];
                      var plot_data = [];

                      for (i = 0; i < data.length; i++) {
                        var country = data[i]["geo\\time"];
                        for (j = 0; j < years.length; j++) {
                          var values_by_year = Object.values(data[i]).slice(1, );
                          data_by_country[country] = values_by_year;
                        }
                        var trace = {
                          x: years,
                          y: data_by_country[country],
                          name: country
                        }
                        plot_data.push(trace);
                      }
                      var layout = {
                        xaxis: {
                          type: 'category',
                          title: 'Year'
                        },
                        yaxis: {
                          title: 'Emissions (tons per capita)'
                        },
                        legend: {
                          itemclick: 'toggleothers',
                          itemdoubleclick: 'toggle'
                        },
                        hoverinfo: 'text+y',
                        hovermode: 'closest'
                      };

                      Plotly.plot( ghg_emissions_plot, plot_data, layout, {scrollZoom: true})

                    });

            d3.tsv("processed_data/share_renewable/share_renewable.tsv")
                    .then(function(data) {
                      var data_by_country = {};

                      var years = [2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016, 2017];
                      var plot_data = [];

                      for (i = 0; i < data.length; i++) {
                        var country = data[i]["geo\\time"];
                        for (j = 0; j < years.length; j++) {
                          var values_by_year = Object.values(data[i]).slice(1, );
                          data_by_country[country] = values_by_year;
                        }
                        var trace = {
                          x: years,
                          y: data_by_country[country],
                          name: country
                        }
                        plot_data.push(trace);
                      }
                      var layout = {
                        xaxis: {
                          type: 'category',
                          title: 'Year'
                        },
                        yaxis: {
                          title: 'Share of energy from renewable sources (%)'
                        },
                        legend: {
                          itemclick: 'toggleothers',
                          itemdoubleclick: 'toggle'
                        },
                        hoverinfo: 'text+y',
                        hovermode: 'closest'
                      };

                      Plotly.plot( share_renewable_plot, plot_data, layout, {scrollZoom: true})

                    });

            d3.tsv("processed_data/share_renewable/share_renewable.tsv")
                    .then(function(data) {
                      var data_by_country = {};

                      for (i = 0; i < data.length; i++) {
                        var country = data[i]["geo\\time"];
                        var values_by_year = Object.values(data[i])[14];
                        data_by_country[country] = values_by_year;
                      }
                        var trace = {
                          locations: Object.keys(data_by_country),
                          z: Object.values(data_by_country),
                          type: 'choropleth',
                          geo: 'geo',
                          colorscale: [
                                  ['0', 'red'],
                                  ['0.5', 'yellow'],
                                  ['1', 'green']
                          ],
                          reversescale: false
                        }
                      var layout = {
                        title: 'Share of energy consumption from renewable sources in 2017 (in %)',
                        geo: {
                          projection: 'mercator',
                          domain: {
                            x: [0, 1],
                            y: [0, 1]
                          },
                          lonaxis: { range: [-25, 45] },
                          lataxis: { range: [30, 80] }
                        },
                        hoverinfo: 'text+y',
                        hovermode: 'closest'
                      };

                    data = [trace]
                    Plotly.plot( map_renewables_2017, data, layout, {scrollZoom: true})

                    });

          </script>
        </div> -->

        <div class="row">
          <div class="col">
            <div id="geomap" style="height:600px; width: 600px"></div>
            <script>
              var main_map = L.map('geomap').setView([54,10], 3);
              function onMapClick(e) {
                alert("You clicked " + e.layer);
              }

              L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {
                attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://www.mapbox.com/">Mapbox</a>',
                maxZoom: 18,
                id: 'mapbox/streets-v11',
                accessToken: 'pk.eyJ1IjoibGhlbm5lIiwiYSI6ImNrNWJsaXhidDFoeDczcGxqaGxrbnJ2Y20ifQ.U1dvdEcuMIcf41VGJNC6zQ'
              }).addTo(main_map);
              var geojsonLayer = new L.GeoJSON.AJAX("europe.geojson");
              geojsonLayer.addTo(main_map);
              main_map.on('click', onMapClick);
            </script>
          </div>
          <div class="col">

          </div>
        </div>
        </div>
      </div>
    </div>
  </section>

  <section id="original-datasets">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 mx-auto">
          <h2>Original datasets</h2>
          <div class="card-deck">
            <div class="card">
              <div class="card-header">
                <h5 class="card-title">Eurobarometers on climate change</h5>
              </div>
              <div class="card-body">
                <div class="card-text">
                  <a href="https://data.europa.eu/euodp/en/data/dataset/S1461_69_2_300">Eurobarometer 300</a><br/>
                  <a href="https://data.europa.eu/euodp/en/data/dataset/S942_71_1_EBS313">Eurobarometer 313</a><br/>
                  <a href="https://data.europa.eu/euodp/en/data/dataset/S703_72_1_EBS322">Eurobarometer 322</a><br/>
                  <a href="https://data.europa.eu/euodp/en/data/dataset/S1007_75_4_EBS372">Eurobarometer 372</a><br/>
                  <a href="https://data.europa.eu/euodp/en/data/dataset/S1084_80_2_409">Eurobarometer 409</a><br/>
                  <a href="https://data.europa.eu/euodp/en/data/dataset/S2060_83_4_435_ENG">Eurobarometer 435</a><br/>
                  <a href="https://data.europa.eu/euodp/en/data/dataset/S2140_87_1_459_ENG">Eurobarometer 459</a><br/>
                  <a href="https://data.europa.eu/euodp/en/data/dataset/S2212_91_3_490_ENG">Eurobarometer 490</a><br/>
                </div>
              </div>
            </div>
            <div class="card">
              <div class="card-header">
                <h5 class="card-title">Data on greenhouse gas emissions</h5>
              </div>
              <div class="card-body">
                <div class="card-text">
                  <p><a href="https://data.europa.eu/euodp/en/data/dataset/rc2ELCDeTGfxdpE27gyzow">Eurostat data on Greenhouse gas emissions per capita</a></p>
                </div>
              </div>
            </div>
            <div class="card">
              <div class="card-header">
                <h5 class="card-title">Share of renewable energy</h5>
              </div>
              <div class="card-body">
                <div class="card-text">
                  <p><a href="https://data.europa.eu/euodp/en/data/dataset/kLwnawdAsL0qfRS0PzvDfw">Eurostat data on the share of renewable energy in gross final energy consumption</a></p>
                </div>
              </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section id="output-datasets">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 mx-auto">
          <h2>Output datasets</h2>
          <p class="lead"></p>
        </div>
      </div>
    </div>
  </section>

  <section id="documentation">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 mx-auto">
          <h2>Documentation</h2>
          <p class="lead">The project was documented extensively along the development process. The documentation can be found within the project's <a href="https://github.com/climate-change-in-the-EU/climate-change-in-the-EU.github.io">Github repository</a></p>
        </div>
      </div>
    </div>
  </section>

  <section id="license">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 mx-auto">
          <h2>License</h2>
          <p class="lead"><i>Scrolling Nav</i> Bootstrap template is licensed under The MIT License (MIT), &copy; 2013-2019 Blackrock Digital LLC.</p>
          <p class="lead">Datasets licensed under the Creative Commons 4.0 License:</p>
          <p class="lead">Datasets licensed according to the European Commission's legal guidelines:</p>
        </div>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="py-5 bg-dark">
    <div class="container">
      <p class="m-0 text-center text-white">&copy; Elisabeth Reuhl, Lukas Henne 2020</p>
    </div>
    <!-- /.container -->
  </footer>

  <!-- Bootstrap core JavaScript -->
  <script src="vendor/jquery/jquery.min.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.bundle.min.js"></script>

  <!-- Plugin JavaScript -->
  <script src="vendor/jquery-easing/jquery.easing.min.js"></script>

  <!-- Custom JavaScript for this theme -->
  <script src="js/scrolling-nav.js"></script>

</body>

</html>
